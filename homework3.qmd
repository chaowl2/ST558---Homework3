---
title: "Homework 3"
format: html
editor: visual
---

## Task 1: Control Flow Practice

### Step 0

```{r}
# Load rda file
load("hw2_list.rda")
```

### Step 1

```{r}
# Creating new columns in both dataframes of vector length n
bp_list$treatment$status = character(nrow(bp_list$treatment))
bp_list$placebo$status = character(nrow(bp_list$placebo))
```

### Step 2

```{r}
# Fill status for treatment group
for (i in seq_len(nrow(bp_list$treatment))) {
  bp = bp_list$treatment$post_bp[i]
  
  if (is.na(bp)) {
    bp_list$treatment$status[i] = NA_character_
  } else if (bp <= 120) {
    bp_list$treatment$status[i] = "optimal"
  } else if (bp <= 130) {
    bp_list$treatment$status[i] = "borderline"
  } else {
    bp_list$treatment$status[i] = "high"
  }
}
```

### Step 3

```{r}
# Fill status for placebo group
for (i in seq_len(nrow(bp_list$placebo))) {
  bp = bp_list$placebo$post_bp[i]
  
  if (is.na(bp)) {
    bp_list$placebo$status[i] = NA_character_
  } else if (bp <= 120) {
    bp_list$placebo$status[i] = "optimal"
  } else if (bp <= 130) {
    bp_list$placebo$status[i] = "borderline"
  } else {
    bp_list$placebo$status[i] = "high"
  }
}
```

## Task 2: Function Writing

The function below:

1\) takes a list with two data frames (\`treatment\` and \`placebo\`),

2\) takes a descriptive statistic as a quoted string with default "`mean`",

3\) uses \`get(stat)\` to fetch the R function,

4\) computes the statistic on the \`pre_bp\`, \`post_bp\`, and \`diff_bp\` columns for both data frames,

5\) returns a named list of six values.

```{r}
# Returns a vector
summarize_bp_vec = function(lst, stat = "mean") {
  # get the function from the quoted string
  my_function = get(stat, mode = "function")
  
  groups = c("treatment", "placebo")
  columns = c("pre_bp", "post_bp", "diff_bp")
  
  out_vals = numeric(length(groups) * length(columns))
  out_names = character(length(out_vals))
  
  k = 0L
  for (g in groups) {
    for (col in columns) {
      k = k + 1L
      x = lst[[g]][[col]]
      out_vals[k] = my_function(x, na.rm = TRUE)
      # names
      out_names[k] = paste(g, sub("_bp$", "", col), stat, sep = "_")
    }
  }
  
  names(out_vals) = out_names
  out_vals
}
```

### Running function on bp_list

```{r}
res_mean <- summarize_bp_vec(bp_list)   # default 
res_var <- summarize_bp_vec(bp_list, stat = "var")
res_sd  <- summarize_bp_vec(bp_list, stat = "sd")
res_min <- summarize_bp_vec(bp_list, stat = "min")
res_max <- summarize_bp_vec(bp_list, stat = "max")
```

```{r}
res_mean
res_var
res_sd
res_min
res_max
```
